<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="Style.css">
  <script src="https://cdn.jsdelivr.net/npm/p5@1.11.10/lib/p5.js"></script>
  <title>Assignment 7 </title>
</head>
<script
      type="module"
      src="https://unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.esm.js"
    ></script>
    <script
      nomodule
      src="https://unpkg.com/ionicons@5.4.0/dist/ionicons/ionicons.js"
    ></script>
</head>

<header class="header">
      <a href="index.html">
        <img class="logo" src="images/logo.png" alt="portfolio logo" />
      </a>

      <nav class="main-nav">
        <ul class="main-nav-list">
          <li><a class="main-nav-link" href="index.html">Home</a></li>
          <li><a class="main-nav-link" href="portfolio.html">Portfolio</a></li>
          <li><a class="main-nav-link" href="about.html">About</a></li>
          <li><a class="main-nav-link" href="contact.html">Contact</a></li>
        </ul>
      </nav>
    </header>
<body>
  <h1>Autobiographical game</h1>
  <div id="sketch-container"></div>



    <script>
// Game Control Variables //
let scene = 0;          
let canAdvance = true;  
let showPopup = false;  
let popupMessage = ""; 
let cloudImg
let snowflakeImg
let nightImg

// Player Class//
class Player {
  constructor(x, y) {
    this.x = x;
    this.y = y;
    this.w = 18;
    this.h = 18;
    this.speed = 2.1;
  }

  move() {
    let vx = 0;
    let vy = 0;

    if (keyIsDown(LEFT_ARROW)) {
      vx = -this.speed;
    } else if (keyIsDown(RIGHT_ARROW)) {
      vx = this.speed;
    }

    if (keyIsDown(UP_ARROW)) {
      vy = -this.speed;
    } else if (keyIsDown(DOWN_ARROW)) {
      vy = this.speed;
    }

    this.x = this.x + vx;
    this.y = this.y + vy;

    // keep inside canvas
    if (this.x < 0) {
      this.x = 0;
    }
    if (this.x + this.w > width) {
      this.x = width - this.w;
    }
    if (this.y < 0) {
      this.y = 0;
    }
    if (this.y + this.h > height) {
      this.y = height - this.h;
    }
  }

  show() {
    fill(255,100, 20);
    rect(this.x, this.y, this.w, this.h, 4);
  }
}

// Collision Function //
function intersects(a, b) {
  if (a.x < b.x + b.w &&
      a.x + a.w > b.x &&
      a.y < b.y + b.h &&
      a.y + a.h > b.y) {
    return true;
  } else {
    return false;
  }
}

// Scene Variables//
let player;

// scene 1 - morning
let s1_tokens = [];
let s1_hazards = [];

// scene 2 - city
let dayItems = ["food","water","friends","DT","study","work","yoga","gym","walk","coffee"];
let s2_tokens = [];
let s2_blocks = [];
let collectedLabels = [];
let GROW_BY = 5;
let MAX_WIDTH = 120;

// scene 3 - evening
let revealBlocks = [];
let revealedCount = 0;

function preload() {
  cloudImg = loadImage('images/cloud-1.png');
  snowflakeImg = loadImage('images/snowflake.png');
  nightImg = loadImage ('images/night.png')
}

// Setup //
function setup() {
   let canvas = createCanvas(600, 400);
  canvas.parent('sketch-container')
  textFont('sans-serif');
  initTitle();
}

// Main Draw Loop //
function draw() {
  // base background 
  background(235);

  switch (scene) {
  case 0:
    drawTitle();
    break;
  case 1:
    drawScene1();
    break;
  case 2:
    drawScene2();
    break;
  case 3:
    drawScene3();
    break;
}

  // popup
  if (showPopup === true) {
    fill(0, 160);
    rect(0, 0, width, height);
    fill(255);
    textAlign(CENTER, CENTER);
    textSize(16);
    text(popupMessage + "\n\nPress ENTER", width / 2, height / 2);
  }
}

//  Scene 0: Title //
function initTitle() {
  player = new Player(width/2, height - 250);
  canAdvance = true;
  showPopup = false;
}

function drawTitle() {
  background(0, 230, 220); 

  fill(80, 80, 130);
  textAlign(CENTER, TOP);
  textSize(22);
  text("Balancing Worlds", width / 2, 70);
  textSize(14);
  text("Press ENTER to start", width / 2, 300);

  player.move();
  player.show();
}

// Scene 1: Morning Message //
function initScene1() {
  player = new Player(50, height - 50);
  canAdvance = false;
  showPopup = false;

  // messages from kids/family
  s1_tokens = [
    {x:120,y:90,w:32,h:32,label:"letter",active:true},
    {x:280,y:150,w:32,h:32,label:"photo",active:true},
    {x:470,y:110,w:32,h:32,label:"call",active:true},
    {x:320,y:200,w:32,h:32,label:"love",active:true},
    {x:220,y:320,w:32,h:32,label:"talk",active:true},
    {x:400,y:180,w:32,h:32,label:"care",active:true},
  
  ];

  // floating clouds (homesickness)
  s1_hazards = [];
  for (let i = 0; i < 9; i++) {
    let cloud = {
      x: random(80, width - 80),
      y: random(80, height - 60),
      w: 26,
      h: 26,
      vx: random([-0.55, 0.55]),
      vy: random([-0.4, 0.9])
    };
    s1_hazards.push(cloud);
  }
}

function drawScene1() {
  background(90, 120, 245); 

  player.move();
  player.show();

  // tokens (messages)
  for (let i = 0; i < s1_tokens.length; i++) {
    let t = s1_tokens[i];
    if (t.active === true) {
      // different pastel colors for each type
      if (t.label === "letter") {
        fill(255, 240, 200); 
      } else if (t.label === "photo") {
        fill(220, 230, 255); 
      } else if (t.label === "call") {
        fill(255, 220, 240); 
      } else if (t.label === "talk") {
        fill(200, 180, 120); 
      } else if (t.label === "love") {
        fill(255, 190, 203); 
      } else if (t.label === "care") {
        fill(220, 255, 210); 
       } else {
       fill(200);          
      }

      rect(t.x, t.y, t.w, t.h, 5);

      fill(50);
      textAlign(CENTER, CENTER);
      textSize(11);
      text(t.label, t.x + t.w / 2, t.y + t.h / 2);

      if (intersects(player, t) === true) {
        t.active = false;
      }
    }
  }

 // clouds
for (let i = 0; i < s1_hazards.length; i++) {
  let h = s1_hazards[i];

  h.x = h.x + h.vx;
  h.y = h.y + h.vy;

  // bounce
  if (h.x <= 0 || h.x + h.w >= width) {
    h.vx = -h.vx;
  }
  if (h.y <= 40 || h.y + h.h >= height) {
    h.vy = -h.vy;
  }

  // draw PNG cloud 
  let cloudW = 90;
  let cloudH = 60;
  image(cloudImg, h.x, h.y, cloudW, cloudH);

  if (intersects(player, h) === true) {
    player.x = player.x - 20;
    player.y = player.y + 20;
  }
}

  // check if all collected
  let done = true;
  for (let i = 0; i < s1_tokens.length; i++) {
    if (s1_tokens[i].active === true) {
      done = false;
    }
  }

  if (done === true) {
    canAdvance = true;
    showPopup = true;
    popupMessage = "You are ready to start your adventure of the day.";
  } else {
    canAdvance = false;
  }
}

// Scene 2: City Rhythms (falling snowlakes) //
function initScene2() {
  player = new Player(22, height - 36);
  canAdvance = false;
  showPopup = false;
  collectedLabels = [];
  s2_tokens = [];
  s2_blocks = [];

  // daily items tokens
  for (let i = 0; i < dayItems.length; i++) {
    let token = {
      x: random(70, width - 90),
      y: random(70, height - 60),
      w: 40,
      h: 24,
      label: dayItems[i],
      active: true
    };
    s2_tokens.push(token);
  }

  // falling snowflakes (tasks / pressure)
  for (let i = 0; i < 19; i++) {
    let block = {
      x: random(40, width -40),
      y: random(-200, -40),
      w: random(20, 40),
      h: random(20, 30),
      vy: random(0.5, 2.5)
    };
    s2_blocks.push(block);
  }
}

function drawScene2() {
  background(230, 240, 255); // bright blue daytime

  player.move();
  player.show();

  // falling blocks
for (let i = 0; i < s2_blocks.length; i++) {
  let b = s2_blocks[i];

  b.y = b.y + b.vy;

  if (b.y > width + 30) {
    b.y = random(-200, -40);
    b.x = random(40, width -40);
  }

 // draw snowflake image
let snowflakeSize = 40;    // you can change size
image(snowflakeImg, b.x, b.y, snowflakeSize, snowflakeSize);

  if (intersects(player, b) === true) {
    player.x = 22;
    player.y = height - 36;
  }
}
  // tokens for food, yoga, DT, etc.
  for (let i = 0; i < s2_tokens.length; i++) {
    let t = s2_tokens[i];
    if (t.active === true) {

      // color by category
      if (t.label === "coffee") {
        fill(170, 120, 80);  
      } else if (t.label === "food" || t.label === "water") {
        fill(200, 240, 200); 
      } else if (t.label === "yoga" || t.label === "walk") {
        fill(190, 230, 255); 
      } else if (t.label === "gym") {
        fill(255, 210, 210); 
      } else if (t.label === "DT" || t.label === "study" || t.label === "work") {
        fill(230, 220, 255); 
      } else if (t.label === "friends") {
        fill(255, 240, 190); 
      } else {
        fill(95);
      }

      rect(t.x, t.y, t.w, t.h, 5);

      fill(40);
      textAlign(CENTER, CENTER);
      textSize(11);
      text(t.label, t.x + t.w / 2, t.y + t.h / 2);

      if (intersects(player, t) === true) {
        t.active = false;
        collectedLabels.push(t.label);

        // grow wider (snake feeling)
        player.w = player.w + GROW_BY;
        if (player.w > MAX_WIDTH) {
          player.w = MAX_WIDTH;
        }
        if (player.x + player.w > width) {
          player.x = width - player.w;
        }
      }
    }
  }

  // check all collected
  let allPicked = true;
  for (let i = 0; i < s2_tokens.length; i++) {
    if (s2_tokens[i].active === true) {
      allPicked = false;
    }
  }

  if (allPicked === true) {
    canAdvance = true;
    showPopup = true;
    popupMessage = "You gathered your whole day.";
  } else {
    canAdvance = false;
  }
}

// Scene 3: Evening Reflection //
function initScene3() {
  canAdvance = false;
  showPopup = false;
  revealBlocks = [];
  revealedCount = 0;

  let allWords = ["letter","photo","call"].concat(dayItems);

  for (let i = 0; i < allWords.length; i++) {
    let b = {
      x: random(40, width - 70),
      y: random(60, height - 70),
      w: 54,
      h: 24,
      label: allWords[i],
      revealed: false
    };
    revealBlocks.push(b);
  }

  player = new Player(20, height - 70);
}

function drawScene3() {
  image(nightImg,0, 0);

  // draw and reveal blocks
  for (let i = 0; i < revealBlocks.length; i++) {
    let b = revealBlocks[i];

    // grey before you touch
    if (b.revealed === false) {
      fill(110);
    } else {
      // turn yellow after you touch
      fill(255, 220, 100);
    }

    rect(b.x, b.y, b.w, b.h, 5);

    if (intersects(player, b) === true) {
      if (b.revealed === false) {
        b.revealed = true;
        revealedCount = revealedCount + 1;
      }
    }

    if (b.revealed === true) {
      fill(20);
      textAlign(CENTER, CENTER);
      textSize(11);
      text(b.label, b.x + b.w / 2, b.y + b.h / 2);
    }
  }

  player.move();
  player.show();

  if (revealedCount === revealBlocks.length) {
    canAdvance = true;
    showPopup = true;
    popupMessage = "Your day is written. Well done.";
  }

  fill(220);
  textAlign(CENTER, TOP);
  textSize(12);
  text("Touch each block to reveal the word. (ENTER after the popup)", width / 2, 12);
}

// Key Control //
function keyPressed() {
  if (keyCode === ENTER && canAdvance === true) {
    scene = scene + 1;
    showPopup = false;

    if (scene === 1) {
      initScene1();
    } else if (scene === 2) {
      initScene2();
    } else if (scene === 3) {
      initScene3();
    } else {
      scene = 0;
      initTitle();
    }
  }
}
     

</script>

<p>
    <a href="index.html"> back to homepage</a>
  </p>

<footer class="footer">
      <div class="container grid grid--footer">
        <div class="logo-col">
          <a href="index.html">
            <img class="logo" src="images/logo.png" alt="logo" />
          </a>

          <ul class="social-links">
            <li>
              <a class="footer-link" href="#"
                ><ion-icon name="logo-instagram"></ion-icon
              ></a>
            </li>
            <li>
              <a class="footer-link" href="#"
                ><ion-icon name="logo-facebook"></ion-icon
              ></a>
            </li>
            <li>
              <a class="footer-link" href="#"
                ><ion-icon name="logo-twitter"></ion-icon
              ></a>
            </li>
          </ul>

          <p class="copyright">
            © 2025 My Portfolio. All rights reserved.
          </p>
        </div>

        <div class="address-col">
          <p><strong>Contact</strong></p>
          <p>New York, NY</p>
          <p>
            Email: <a href="mailto:info@myportfolio.com">info@myportfolio.com</a
            ><br />
            Tel: <a href="tel:+16464446464">(646) 444-6464</a>
          </p>
        </div>

        <div class="open-hours">
          <p><strong>Availability</strong></p>
          <ul>
            <li>Mon–Fri: 9:00am–6:00pm</li>
            <li>Sat: By appointment</li>
            <li>Sun: Closed</li>
          </ul>
        </div>
      </div>
    </footer>
</body>
</html>
